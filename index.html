<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>Cloud Processing Engine Client SDK reference</title>

    <link href="stylesheets/screen.css" rel="stylesheet" type="text/css" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" type="text/css" media="print" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
      <script src="javascripts/all.js" type="text/javascript"></script>

      <script>
        $(function() {
          setupLanguages(["php"]);
        });
      </script>
  </head>

  <body class="index">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" />
      </span>
    </a>
    <div class="tocify-wrapper">
      <div>
	<h3 style="text-align: center; color: #fff">Cloud Processing Engine<br>Client SDK</h3>
      </div>
        <div class="lang-selector">
              <a href="#" data-language-name="php">PHP</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc">
      </div>
        <ul class="toc-footer">
            <li><a href='http://sportarchive.github.io/CloudProcessingEngine/' target="_blank">Cloud Processing Engine (CPE) documentation</a></li>
        </ul>
      <h5 style="text-align: center; color: #fff">Project sponsored by</h5>
      <h5 style="text-align: center;"><img src="images/logo.png" /></h5>
      <h5 style="text-align: center; color: #fff; margin-bottom: 0px;">Sport Archive Inc.</h5>
      <div style="text-align: center; margin-bottom: 0px; "><a href="#" style="color: #fff">http://sportarchive.tv</a></div>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id="introduction">Introduction</h1>

<blockquote>
<p>PHP implementation of this SDK is available here:<br>
<a href="https://github.com/sportarchive/CloudProcessingEngine-PHP-Client-SDK" target="_blank">https://github.com/sportarchive/CloudTranscode-PHP-SDK</a></p>
</blockquote>

<p>Welcome to the Cloud Processing Engine (CPE) Client SDK documentation.</p>

<p>The CPE Client SDK allows you to communicate with the CPE stack through AWS SQS.
You can use it to:</p>

<ul>
<li>Submit Jobs</li>
<li>Listen to updates</li>
<li>Cancel Jobs</li>
<li>Get status</li>
</ul>

<p>It is a simple AWS SQS interface. It reads and writes the proper JSON format expected by the CT stack.</p>

<h1 id="dependencies">Dependencies</h1>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"YOUR CLIENT NAME"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"queues"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"input"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://sqs.[region].amazonaws.com/[AWS account]/[sqs-input-queue-name]"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"output"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://sqs.[region].amazonaws.com/[AWS account]/[sqs-output-queue-name]"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Before integrating the SDK into your application, you must register your application into the stack.</p>

<p>The stack maintains a list of clients in its configuration file.
Each client has the following information:</p>

<ul>
<li>name: The name of the client.</li>
<li>queues: The input and output SQS queues dedicated for this client.</li>
</ul>

<p>Make a copy of the JSON object defining your client and save into your application.</p>

<p>The CT SDK will use your client definition in order to know the SQS queues to use for reading and writing messages. It expects a raw JSON text.</p>

<h1 id="install">Install</h1>

<blockquote>
<p>Use Composer to install the PHP SDK<br>
<a href="https://packagist.org/packages/sportarchive/cloud-transcode-php-sdk" target="_blank">https://packagist.org/packages/sportarchive/cloud-transcode-php-sdk</a></p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"require"</span><span class="p">:</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="s2">"sportarchive/cloud-transcode-php-sdk"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dev-master"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Install the CT SDK in your project using the proper dependency manager for your language.</p>

<aside class="notice">
You can also install it by hand by just copying the file in your project.
</aside>

<h1 id="instantiate">Instantiate</h1>

<blockquote>
<p>Pass your AWS credentials to the constructor and your client JSON .</p>
</blockquote>
<pre class="highlight ruby"><code><span class="sr">/* Composer autoload to be at the top of your file */</span>
<span class="nb">require</span> <span class="n">__DIR__</span> <span class="o">.</span> <span class="s2">"/../vendor/autoload.php"</span><span class="p">;</span>

<span class="vg">$CTComSDK</span> <span class="o">=</span> <span class="kp">new</span> <span class="no">SA</span><span class="p">\</span><span class="no">CTComSDK</span><span class="p">(</span><span class="vg">$key</span><span class="p">,</span> <span class="vg">$secret</span><span class="p">,</span> <span class="vg">$region</span><span class="p">,</span> <span class="vg">$client_def</span><span class="p">,</span> <span class="vg">$debug</span><span class="p">);</span>
</code></pre>

<p>In your application, instantiate the SDK to access its methods.</p>

<ul>
<li>key: AWS Key</li>
<li>secret: AWS Secret</li>
<li>region: AWS region</li>
<li>client_def: String containg JSON client definition (same as in the Stack config file)</li>
</ul>

          <h1 id="sending-commands">Sending commands</h1>

<h2 id="start-job">Start Job</h2>
<pre class="highlight ruby"><code><span class="sr">/**
 * $json_input: Contains the Job description
 * $job_id: You must generate it and save it somewhere.
**/</span>
<span class="vg">$CTComSDK</span><span class="o">-&gt;</span><span class="n">start_job</span><span class="p">(</span><span class="vg">$json_input</span><span class="p">,</span> <span class="vg">$job_id</span><span class="p">);</span>
</code></pre>

<aside class="notice">
Call this method to start a new Transcoding Job. This method will take your JSON payload and will send it to the &lsquo;input&rsquo; SQS queue configured for your client.
</aside>

<p>The JSON input you pass in parameter contains information task you want to execute. You can analyse assets or transcode them.</p>

<p>When transcoding assets, you need to specify an &ldquo;output&rdquo; that contains the resulting output you want.</p>

<h2 id="cancel-job">Cancel Job</h2>

<p>TODO</p>

<h2 id="get-job-list">Get Job List</h2>

<p>TODO</p>

<h2 id="get-job-status">Get Job Status</h2>

<p>TODO</p>

<h1 id="input-description">Input description</h1>

<h2 id="workflow">Workflow</h2>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"workflow"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SATranscode"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1.0"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"taskList"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SATranscodeThumb"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"domain"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SADomain"</span><span class="w">
        </span><span class="p">},</span><span class="w">
</span><span class="err">...</span><span class="w">
</span></code></pre>

<p>This describes the workflow where to submit your job to. The workflow is defined in the Plan YAML submitted to your Decider.</p>

<p>For more information about the Decider and the plans, visit: </p>

<h2 id="input-file">Input File</h2>
<pre class="highlight json"><code><span class="err">...</span><span class="w">
    </span><span class="s2">"input_type"</span><span class="err">:</span><span class="w"> </span><span class="s2">"VIDEO"</span><span class="err">,</span><span class="w">
    </span><span class="s2">"input_bucket"</span><span class="err">:</span><span class="w"> </span><span class="s2">"ClientA-bucket-in"</span><span class="err">,</span><span class="w">
    </span><span class="s2">"input_file"</span><span class="err">:</span><span class="w"> </span><span class="s2">"/input1/test1.mp4"</span><span class="err">,</span><span class="w">
    </span><span class="s2">"outputs"</span><span class="err">:</span><span class="w"> 
    </span><span class="p">[</span><span class="w">
</span><span class="err">...</span><span class="w">
</span></code></pre>

<p>This describe the JSON field describing the input file.</p>

<table><thead>
<tr>
<th>key</th>
<th>type</th>
<th>default</th>
<th>mandatory</th>
<th>description</th>
<th>values</th>
</tr>
</thead><tbody>
<tr>
<td>input_type</td>
<td>string</td>
<td>none</td>
<td>yes</td>
<td>Type of the input file to transcode</td>
<td>VIDEO, AUDIO, DOC, IMG</td>
</tr>
<tr>
<td>input_bucket</td>
<td>string</td>
<td>none</td>
<td>yes</td>
<td>S3 bucket name</td>
<td>any</td>
</tr>
<tr>
<td>input_file</td>
<td>string</td>
<td>none</td>
<td>yes</td>
<td>filename of the file to download</td>
<td>any</td>
</tr>
<tr>
<td>job_label</td>
<td>string</td>
<td>job_id</td>
<td>no</td>
<td>Give a name to your job</td>
<td>any</td>
</tr>
<tr>
<td>outputs</td>
<td>array</td>
<td>none</td>
<td>yes</td>
<td>List of all the outputs needed for that job</td>
<td>array of max 100 entries</td>
</tr>
</tbody></table>

<h2 id="common-output-description">Common Output description</h2>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
</span><span class="err">...</span><span class="w">
    </span><span class="s2">"output"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"output_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"VIDEO"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"output_bucket"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ClientA-bucket-out"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"output_file"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/output1/test1_sd.mp4"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"s3_rrs"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
            </span><span class="s2">"s3_encrypt"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
</span></code></pre>

<p>These are the common JSON fields describing any output files of any types.</p>

<p>The output_type field is dependent on the input_type field. You cannot convert a VIDEO into a DOC for example.</p>

<table><thead>
<tr>
<th>key</th>
<th>type</th>
<th>default</th>
<th>mandatory</th>
<th>description</th>
<th>values</th>
</tr>
</thead><tbody>
<tr>
<td>output_type</td>
<td>string</td>
<td>none</td>
<td>yes</td>
<td>Type of the file to ouput</td>
<td>VIDEO, THUMB, AUDIO, DOC, IMG</td>
</tr>
<tr>
<td>output_bucket</td>
<td>string</td>
<td>none</td>
<td>yes</td>
<td>S3 bucket where the ouput file will be uploaded</td>
<td>any</td>
</tr>
<tr>
<td>output_file</td>
<td>string</td>
<td>none</td>
<td>yes</td>
<td>Path and filename of the file to generate and upload</td>
<td>any</td>
</tr>
<tr>
<td>s3_rrs</td>
<td>string</td>
<td>false</td>
<td>no</td>
<td>Activate Reduced redundancy or not in S3 storage</td>
<td>true, false</td>
</tr>
<tr>
<td>s3_encrypt</td>
<td>string</td>
<td>false</td>
<td>no</td>
<td>Activate backend storage encryption</td>
<td>true,false</td>
</tr>
</tbody></table>

<h2 id="video-output-description">Video Output description</h2>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
</span><span class="err">...</span><span class="w">
    </span><span class="s2">"output"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"output_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"VIDEO"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"output_bucket"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ClientA-bucket-out"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"output_file"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/output1/test1_sd.mp4"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"s3_rrs"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
            </span><span class="s2">"s3_encrypt"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
            </span><span class="s2">"preset"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                  </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"System preset: Generic iphone4S"</span><span class="p">,</span><span class="w">
                  </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Generic transcoding preset for: iPhone 4s and above, iPad 3G and above, iPad mini, Samsung Galaxy S2/S3/Tab 2"</span><span class="p">,</span><span class="w">
                  </span><span class="s2">"size"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1920x1080"</span><span class="p">,</span><span class="w">
                  </span><span class="s2">"frame_rate"</span><span class="p">:</span><span class="w"> </span><span class="mi">30</span><span class="p">,</span><span class="w">
                  </span><span class="s2">"video_bitrate"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5000k"</span><span class="p">,</span><span class="w">
                  </span><span class="s2">"audio_bitrate"</span><span class="p">:</span><span class="w"> </span><span class="s2">"160k"</span><span class="p">,</span><span class="w">
                  </span><span class="s2">"video_codec"</span><span class="p">:</span><span class="w"> </span><span class="s2">"libx264"</span><span class="p">,</span><span class="w">
                  </span><span class="s2">"audio_codec"</span><span class="p">:</span><span class="w"> </span><span class="s2">"libfdk_aac"</span><span class="p">,</span><span class="w">
                  </span><span class="s2">"video_codec_options"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MaxReferenceFrames:3,Profile:high,Level:4.1"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="s2">"watermark"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                  </span><span class="s2">"input_bucket"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ClientA-bucket-in"</span><span class="p">,</span><span class="w">
                  </span><span class="s2">"input_file"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/watermark/logo.png"</span><span class="p">,</span><span class="w">
                  </span><span class="s2">"size"</span><span class="p">:</span><span class="w"> </span><span class="s2">"75.2x28.4"</span><span class="p">,</span><span class="w">
                  </span><span class="s2">"opacity"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.2</span><span class="p">,</span><span class="w">
                  </span><span class="s2">"x"</span><span class="p">:</span><span class="w"> </span><span class="mi">-20</span><span class="p">,</span><span class="w">
                  </span><span class="s2">"y"</span><span class="p">:</span><span class="w"> </span><span class="mi">-20</span><span class="w">
            </span><span class="p">}</span><span class="w">
     </span><span class="p">}</span><span class="w">
 </span><span class="p">}</span><span class="w">
</span></code></pre>

<p>There are the JSON fields describing VIDEO output files.</p>

<table><thead>
<tr>
<th>key</th>
<th>type</th>
<th>default</th>
<th>mandatory</th>
<th>description</th>
<th>values</th>
</tr>
</thead><tbody>
<tr>
<td>preset</td>
<td>object</td>
<td>none</td>
<td>yes</td>
<td>Preset to use to transcode the file</td>
<td><a href="https://github.com/sportarchive/CloudTranscode-FFMpeg-presets" target="_blank">Find presets</a></td>
</tr>
<tr>
<td>size</td>
<td>string</td>
<td>original size</td>
<td>no</td>
<td>Define output size. Valid for videos and images only</td>
<td><width>x<height></td>
</tr>
<tr>
<td>video_codec</td>
<td>string</td>
<td>from preset</td>
<td>no</td>
<td>Override the video codec used by preset</td>
<td>ffmpeg codec</td>
</tr>
<tr>
<td>audio_codec</td>
<td>string</td>
<td>from preset</td>
<td>no</td>
<td>Override the audio codec used by preset</td>
<td>ffmpeg codec</td>
</tr>
<tr>
<td>video_bitrate</td>
<td>string</td>
<td>from preset</td>
<td>no</td>
<td>Override video bitrate used by preset</td>
<td>valid bitrate</td>
</tr>
<tr>
<td>audio_bitrate</td>
<td>string</td>
<td>from preset</td>
<td>no</td>
<td>Override audio bitrate used by preset</td>
<td>valid bitrate</td>
</tr>
<tr>
<td>frame_rate</td>
<td>string</td>
<td>from preset</td>
<td>no</td>
<td>Override framerate used by preset</td>
<td>valid framerate</td>
</tr>
<tr>
<td>watermark</td>
<td>object</td>
<td>none</td>
<td>no</td>
<td>Describe watermark for the video</td>
<td>see <a href="#watermark">Watermark</a> section</td>
</tr>
<tr>
<td>keep_ratio</td>
<td>boolean</td>
<td>true</td>
<td>no</td>
<td>Keep the ratio of the original video. 4:3 or 16:9</td>
<td>true,false</td>
</tr>
<tr>
<td>no_enlarge</td>
<td>boolean</td>
<td>true</td>
<td>no</td>
<td>Prevent enlarging the video size from original, even if bigger size is provided.</td>
<td>true,false</td>
</tr>
</tbody></table>

<h3 id="watermark-object">Watermark object</h3>
<pre class="highlight json"><code><span class="err">...</span><span class="w">
    </span><span class="s2">"watermark"</span><span class="err">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"input_bucket"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ClientA-bucket-in"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"input_file"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/watermark/logo.png"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"size"</span><span class="p">:</span><span class="w"> </span><span class="s2">"75.2x28.4"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"opacity"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.2</span><span class="p">,</span><span class="w">
        </span><span class="s2">"x"</span><span class="p">:</span><span class="w"> </span><span class="mi">-20</span><span class="p">,</span><span class="w">
        </span><span class="s2">"y"</span><span class="p">:</span><span class="w"> </span><span class="mi">-20</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="err">...</span><span class="w">
</span></code></pre>

<p>Use this object within a VIDEO output description to overlay an image on top of the video.</p>

<p>You can control many aspects of that image using the options below.</p>

<table><thead>
<tr>
<th>key</th>
<th>type</th>
<th>default</th>
<th>mandatory</th>
<th>description</th>
<th>values</th>
</tr>
</thead><tbody>
<tr>
<td>input_butcket</td>
<td>string</td>
<td>none</td>
<td>yes</td>
<td>Bucket name where the watermark is located</td>
<td>any</td>
</tr>
<tr>
<td>input_file</td>
<td>string</td>
<td>none</td>
<td>yes</td>
<td>Filename and path of the file containing the watermark</td>
<td>any</td>
</tr>
<tr>
<td>size</td>
<td>string</td>
<td>file default size</td>
<td>no</td>
<td>Size of the watermark in the video result</td>
<td>any</td>
</tr>
<tr>
<td>opacity</td>
<td>string</td>
<td>0.7</td>
<td>no</td>
<td>Change the default watermark opacity</td>
<td>0.1 to 1.0</td>
</tr>
<tr>
<td>x</td>
<td>string</td>
<td>-10</td>
<td>no</td>
<td>Change the watermark position. In pixels.</td>
<td>-0 to -n, 0 to n</td>
</tr>
<tr>
<td>y</td>
<td>string</td>
<td>-10</td>
<td>no</td>
<td>Change the watermark position. In pixels.</td>
<td>-0 to -n, 0 to n</td>
</tr>
</tbody></table>

<h2 id="thumb-output-description">Thumb Output description</h2>

<blockquote>
<p>Generates a thumbnail from a precise location in the video (in seconds)</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
</span><span class="err">...</span><span class="w">
    </span><span class="s2">"output"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"output_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"THUMB"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"mode"</span><span class="p">:</span><span class="w"> </span><span class="s2">"snapshot"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"output_bucket"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ClientA-bucket-out"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"output_file"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/output1/thumbs/test1_thumb.jpg"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"s3_rrs"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
            </span><span class="s2">"s3_encrypt"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
            </span><span class="s2">"size"</span><span class="p">:</span><span class="w"> </span><span class="s2">"160x120"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"snapshot_sec"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>Generates N thumbnails at each intervals (in seconds)</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
</span><span class="err">...</span><span class="w">
    </span><span class="s2">"output"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"output_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"THUMB"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"mode"</span><span class="p">:</span><span class="w"> </span><span class="s2">"intervals"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"output_bucket"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ClientA-bucket-out"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"output_file"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/output1/thumbs_interval/test2_thumb.jpg"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"s3_rrs"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
            </span><span class="s2">"s3_encrypt"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
            </span><span class="s2">"size"</span><span class="p">:</span><span class="w"> </span><span class="s2">"160x120"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"intervals"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>These are the output attributes you must provide to generate thumbnails from a video. Thumbnails are an output_type on its own.</p>

<table><thead>
<tr>
<th>key</th>
<th>type</th>
<th>default</th>
<th>mandatory</th>
<th>description</th>
<th>values</th>
</tr>
</thead><tbody>
<tr>
<td>mode</td>
<td>string</td>
<td>snapshot</td>
<td>no</td>
<td>Type of thumbnails generation needed</td>
<td>snapshot, intervals</td>
</tr>
<tr>
<td>output_bucket</td>
<td>string</td>
<td>none</td>
<td>yes</td>
<td>S3 bucket and path where the ouput thumbnails will be uploaded</td>
<td>any</td>
</tr>
<tr>
<td>output_file</td>
<td>string</td>
<td>none</td>
<td>yes</td>
<td>filename for your thumbnails.We will append sequence number</td>
<td>any</td>
</tr>
<tr>
<td>intervals</td>
<td>integer</td>
<td>10</td>
<td>no</td>
<td>Override default interval in seconds.</td>
<td>any</td>
</tr>
<tr>
<td>snapshot_sec</td>
<td>interger</td>
<td>0</td>
<td>no</td>
<td>Second in the video when to take the snapshot</td>
<td>any</td>
</tr>
<tr>
<td>size</td>
<td>string</td>
<td>none</td>
<td>yes</td>
<td>Size of the thumbnails</td>
<td>any</td>
</tr>
</tbody></table>

          <h1 id="listening-for-updates">Listening for updates</h1>
<pre class="highlight ruby"><code><span class="sr">/* Keep polling for messages! Forever ... */</span>
<span class="k">while</span> <span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">try</span> <span class="p">{</span>
        <span class="sr">/* Will poll for 10 seconds then return */</span>
        <span class="k">if</span> <span class="p">(</span><span class="vg">$msg</span> <span class="o">=</span> <span class="vg">$CTComSDK</span><span class="o">-&gt;</span><span class="n">receive_message</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="vg">$decoded</span> <span class="o">=</span> <span class="n">json_decode</span><span class="p">(</span><span class="vg">$msg</span><span class="p">[</span><span class="s1">'Body'</span><span class="p">])))</span>
                <span class="kp">throw</span> <span class="kp">new</span> <span class="no">Exception</span><span class="p">(</span><span class="s2">"JSON data is invalid!"</span><span class="p">);</span>
            <span class="k">else</span>
            <span class="p">{</span>
                <span class="sr">/* Custom function that will parse the JSON data and do something */</span>
                <span class="n">parse_output</span><span class="p">(</span><span class="vg">$decoded</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="sr">/* Message polled. We delete it from SQS */</span>
            <span class="vg">$CTComSDK</span><span class="o">-&gt;</span><span class="n">delete_message</span><span class="p">(</span><span class="vg">$msg</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span> <span class="kp">catch</span> <span class="p">(</span><span class="no">Exception</span> <span class="vg">$e</span><span class="p">)</span> <span class="p">{</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"[ERROR] "</span> <span class="o">.</span> <span class="vg">$e</span><span class="o">-&gt;</span><span class="n">getMessage</span><span class="p">()</span> <span class="o">.</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>

<aside class="notice">
Call this method to retrieve a possible message from the stack. This method polls messages from the &lsquo;output&rsquo; SQS channel configured for your client.
</aside>

<p>The method will poll the &#39;output&rsquo; SQS queue. If no message are present it returns &#39;false&rsquo;.
If there is a message, it returns the String containing this message.</p>

          <h1 id="outputs">Outputs</h1>

<p>Here we must list the outputs the Stack is sending back to the clients</p>

          <h1 id="errors">Errors</h1>

<aside class="notice">Error to be listed here!</aside>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="php">PHP</a>
          </div>
      </div>
    </div>
  </body>
</html>
